name: Novel Crawler

on:
  workflow_dispatch:
    inputs:
      url:
        description: 'URL to crawl (e.g., https://ixdzs.tw/read/212475)'
        required: true
        default: 'https://ixdzs.tw/read/212475'

jobs:
  crawl:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        
    - name: Install dependencies
      run: npm install
      
    - name: Run crawler
      env:
        INPUT_URL: ${{ github.event.inputs.url }}
      run: |
        node script/script.js "${{ github.event.inputs.url }}"
        
    - name: Upload results
      uses: actions/upload-artifact@v4
      with:
        name: novel-results
        path: script/result
        retention-days: 5
